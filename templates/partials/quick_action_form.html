{{ define "quick_action_form.html" }}
<div style="padding: 1rem;">
    <h3 style="margin-bottom: 1.5rem;">{{.Title}}</h3>
    
    <form hx-post="/warehouses/quick-action-execute" 
          hx-target="#warehouses-table"
          hx-on:after-request="if (event.detail.successful) { VendERP.hideActionModal(); }">
        
        <input type="hidden" name="item_id" value="{{.ItemID}}">
        <input type="hidden" name="action_type" value="{{.ActionType}}">
        
        {{if eq .ActionType "adjust"}}
        <div class="form-group">
            <label class="form-label">Текущее количество: <strong>{{.CurrentQuantity}}</strong></label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                <div>
                    <label class="form-label">Тип операции</label>
                    <select name="adjustment_type" class="form-select" required>
                        <option value="add">Добавить</option>
                        <option value="subtract">Убрать</option>
                        <option value="set">Установить значение</option>
                    </select>
                </div>
                <div>
                    <label class="form-label">Количество</label>
                    <input type="number" name="quantity" class="form-input" min="0" required>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label class="form-label">Причина корректировки</label>
            <textarea name="reason" class="form-input" rows="2" 
                      placeholder="Например: Поступление от поставщика, Инвентаризация..."></textarea>
        </div>
        
        {{else if eq .ActionType "transfer"}}
        <div class="form-group">
            <label class="form-label">Перемещение со склада: <strong>{{.SourceWarehouse}}</strong></label>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div class="form-group">
                <label class="form-label">Количество для перемещения</label>
                <input type="number" name="quantity" class="form-input" 
                       min="1" max="{{.CurrentQuantity}}" required>
                <div class="form-help">Доступно: {{.CurrentQuantity}} ед.</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Целевой склад</label>
                <select name="target_warehouse_id" class="form-select" required>
                    <option value="">Выберите склад</option>
                    {{range .Warehouses}}
                    {{if ne .ID $.SourceWarehouseID}}
                    <option value="{{.ID}}">{{.Name}} (свободно: {{subtract .TotalCapacity .CurrentUsage}} ед.)</option>
                    {{end}}
                    {{end}}
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label class="form-label">Примечание</label>
            <textarea name="notes" class="form-input" rows="2" 
                      placeholder="Причина перемещения..."></textarea>
        </div>
        {{end}}
        
        <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
            <button type="button" class="btn" onclick="VendERP.hideActionModal()">Отмена</button>
            <button type="submit" class="btn btn-primary">Выполнить</button>
        </div>
    </form>
</div>
{{ end }}